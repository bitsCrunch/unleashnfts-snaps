<!DOCTYPE html>
<html>
  <head>
    <title>Hello, Snaps!</title>
    <link
      rel="icon"
      type="image/svg"
      href="https://bitscrunch.com/wp-content/uploads/2022/02/cropped-bitsCrunch-logo-270x270.png"
    />
    <link rel="stylesheet" href="index.css">
  </head>

  <body>
    <div class="wrapper">
    <h1 style="color: white;">Unleash NFTs - Snaps!</h1>
    <p style="color: white;">
      Forensic and AI-powered NFT analytics that fight wash trading, fraud and
      give accurate value for digital assets.
    </p>
    <br />
    <div class="container">
      <div class="card" style="--color: #89ec5b">
        <div class="content">
          <div class="icon">
            <img src="https://bitscrunch.com/wp-content/uploads/2022/02/cropped-bitsCrunch-logo-32x32.png" />
            <!-- <ion-icon name="brush-outline"></ion-icon> -->
          </div>
          <div class="text">
            <h3>Install Unleash NFTs Snap</h3>
            <p>Click on the button below to install the snap so that you can have more insights for each transactions</p>
            <button class="connect">Install Unleash NFTs Snap</button>
          </div>
        </div>
      </div>
      <div class="card" style="--color: #eb5ae5">
        <div class="content">
          <div class="icon">
            <img src="https://bitscrunch.com/wp-content/uploads/2022/02/cropped-bitsCrunch-logo-32x32.png" />
            <!-- <ion-icon name="code-slash-outline"></ion-icon> -->
          </div>
          <div class="text">
            <h3>Test Transaction</h3>
            <p>Click on the button below to test the insights for a dummy transaction</p>
            <button class="updateCap">Test Transaction</button>
          </div>
        </div>
      </div>
    </div>
    <!-- <button class="connect">Install Unleash NFTs Snap</button> -->
    <!-- <button class="updateCap">Test Transaction</button> -->
  </body>

  <script>
    const snapId = `local:${window.location.href}`;

    const connectButton = document.querySelector('button.connect');
    const updateCapButton = document.querySelector('button.updateCap');

    const send = (data) => async () => {
      try {
        // Get the user's account from MetaMask.
        const accounts = await ethereum.request({
          method: 'eth_requestAccounts',
        });
        const from = accounts[0];

        // Send a transaction to MetaMask.
        await ethereum.request({
          method: 'eth_sendTransaction',
          params: [
            {
              from,
              to: '0x00000000006c3852cbef3e08e8df289169ede581',
              value: '0x0',
              data,
            },
          ],
        });
      } catch (err) {
        console.error(err);
        alert('Problem happened: ' + err.message || err);
      }
    };

    connectButton.addEventListener('click', connect);

    updateCapButton.addEventListener(
      'click',
      send(
        '0xfb0f3ee100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002d3d1446e480800000000000000000000000000c247c4742ea985bb36af8e7b865d18714165a589000000000000000000000000004c00500000ad104d7dbd00e3ae0a5c00560c00000000000000000000000000f61f24c2d93bf2de187546b14425bf631f28d6dc0000000000000000000000000000000000000000000000000000000000002b280000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000638b865900000000000000000000000000000000000000000000000000000000638b94690000000000000000000000000000000000000000000000000000000000000000360c6ebe000000000000000000000000000000000000000042702992778420e60000007b02230091a7ed01230072f7006a004d60a8d4e71d599b8104250f00000000007b02230091a7ed01230072f7006a004d60a8d4e71d599b8104250f00000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000024000000000000000000000000000000000000000000000000000000000000002e0000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000135a78ee69f8000000000000000000000000000000a26b00c1f0df003000390027140000faa719000000000000000000000000000000000000000000000000001ef727e3dcc0000000000000000000000000009f07b9a10558d69f6403caa274bc4351383be2500000000000000000000000000000000000000000000000000000000000000041773c3249a9c409adfac49ba6363779c259c07992322e8faa5a21f91d91ec05a57f20760953adb6c7e035dfd5f845f477c3215ec6c1b79805d9ffe86da10d28c71c00000000000000000000000000000000000000000000000000000000000000360c6ebe',
      ),
    );

    // here we get permissions to interact with and install the snap
    async function connect() {
      await ethereum.request({
        method: 'wallet_enable',
        params: [
          {
            wallet_snap: {
              [snapId]: {},
            },
          },
        ],
      });
    }
  </script>
</html>
